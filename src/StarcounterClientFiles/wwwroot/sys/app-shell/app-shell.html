<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>{0}</title>
    <script src="/sys/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="/sys/Palindrom/dist/palindrom-dom.js"></script>
    <!-- <script src="/sys/app-shell/palindrom-session-instance.js"></script> -->
    <script>
    (function(){{
        const remoteUrl = '{1}';
        if(!PalindromDOM.instances){{
            PalindromDOM.instances = new Map();
        }}
        const registry = PalindromDOM.instances;
        if(!registry.get(remoteUrl)){{
            registry.set(remoteUrl, new PalindromDOM({{
                remoteUrl,
                "pingIntervalS": 60,
                "useWebSocket": true,
                "debug": false,
                "ot":true,
                "purity":false,
                "localVersionPath": "/_ver#c$",
                "remoteVersionPath": "/_ver#s"
            }}));
            // TODO: set also initial state, so we wan't need additional "establish" request
        }}
    }}());
    </script>
    <link rel="import" href="/sys/polymer/polymer.html">

    <link rel="import" href="/sys/starcounter.html">
    <link rel="stylesheet" href="/sys/underwear.css/underwear.css">
    <link rel="manifest">
</head>
<body>
    <dom-bind id="palindrom-root">
        <template>
            <starcounter-include view-model="{{{{model}}}}"></starcounter-include>
        </template>
    </dom-bind>
    
    <palindrom-client ref="palindrom-root" remote-url="{1}"></palindrom-client>
</body>
</html>
